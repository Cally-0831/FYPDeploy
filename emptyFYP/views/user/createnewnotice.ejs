<script type='text/javascript' charset='UTF-8'>
    (function (config) {  
        config.urlCapture = { 
            filterURLQuery: true
        }
    })(window['adrum-config'] || (window['adrum-config'] = {}));
 </script>
 <script src='//cdn.appdynamics.com/adrum/adrum-latest.js' type='text/javascript' charset='UTF-8'></script>
 
<div class="Pagetitle">
    Create New Notice
</div>
<div class="buttons">
    <div class="button buttonlogout is-left" onclick="history.back()">
        Back
    </div>

</div>
<br>
<div class="columns is-onethird">
    <div class="column"></div>
    <div class="column column-big is-centered ">
        <br>
        <div class="rows">
            <div class="row">
                <label for="title" style="font-size: 20px;">Notice Title</label>

                <%if(title!=null){%>
                    <input type="text" id="title" style="width: 100%; height: 30px;" value="<%=title%>" required>

                    <%}else{%>
                        <input type="text" id="title" style="width: 100%; height: 30px;" required>

                        <%}%>

            </div>

            <br>
            <br>

            <div class="row">
                <label for="content" class="content" style="font-size: 20px;">Content</label>

                <%if(content!=null){%>
                    <textarea id="content" name="content" rows="4" cols="50" style="width:100%"
                        required><%=content%></textarea>
                    <%}else{%>
                        <textarea id="content" name="content" rows="4" cols="50" style="width:100%" required></textarea>

                        <%}%>
            </div>
            <br><br>
            <div class="row">
                <div class="buttons is-right">

                    <button class="buttonlogout" onclick="submitform('<%=id%>')">Submit</button>


                </div>
            </div>
            <br><br>
        </div>
    </div>
    <div class="column"></div>
</div>

<script>
    async function submitform(id) {
        const r = confirm("Confirm to create this notice?");
        var stringstring = document.getElementById("content").value;
        stringstring = stringstring.replace(/\n/g, " newline ");
        console.log("!@#$!@#$!@#$!               " + stringstring)
        var requestBody = JSON.stringify({
            title: document.getElementById("title").value,
            content: stringstring,
            id: id
        });
        if (r) {
            var response = await fetch("/notice/createnewnotice", {
                method: "POST",
                body: requestBody,

            });

            if (response.ok) {

                // var html = await response.text();
                // alert(html);
                alert("Notice Created");
                location.assign("/notice");
            } else {

                alert(response.status + ": " + response.statusText);
            }
        }
    }
</script>
